---
id: 51
title: How to get the Username AND Password of a user in Citrix Web Interface 4.0
date: 2006-03-10T08:30:00-06:00
author: jason
excerpt: 'Have you ever wanted to get the username and password from an authenticated user in Citrix Web Interface?  This article tells you exactly how to do just that.'
layout: post
guid: /post/How-to-get-the-Username-AND-Password-of-a-user-in-Citrix-Web-Interface-40.aspx
permalink: /2006/03/10/how-to-get-the-username-and-password-of-a-user-in-citrix-web-interface-4-0/
categories:
  - Web Interface
tags:
  - API
  - Web Interface
  - XenApp
---
<p>Have you ever wanted to get the username and password from an authenticated user in Citrix Web Interface? I was once tasked to grab the username and password of the authenticated Citrix Web Interface user and pass those credentials along to a custom Lotus Notes web application. Using the Web Interface SDK (available at <a href="http://apps.citrix.com/cdn/sdk/webinterface_sdk.asp" target="_blank">http://apps.citrix.com/cdn/sdk/webinterface_sdk.asp</a>), I was able to get just what I needed. Here is how it&rsquo;s done:<br /><br /><span class="heading">The down and dirty explanation</span><br />The first thing you&rsquo;ll need to understand is the object model Citrix uses in Web Interface. Citrix provides you with a lot of base classes you can use to programmatically get the information you need. All these classes are documented in the SDK. The class we&rsquo;re interested in for this example is the AccessToken class. The AccessToken class allows you to get the user&rsquo;s username (but not the user&rsquo;s password). To get the user&rsquo;s password, you&rsquo;ll need to use the PasswordBasedToken Interface. The AccessToken class implements the PasswordBasedToken interface which exposes a method called getPassword(). This method returns a string that is the user&rsquo;s password. Check out the code below:<br /><br /><span class="heading">The code</span><br /><code>&lt;%<br />PasswordBasedToken pbt = null;<br />AccessToken ac = authGetPrimaryAccessToken();<br />pbt = (PasswordBasedToken)ac;<br /><br />string strUsername = ac.getShortUserName();<br />string strPassword = pbt.getPassword();<br />%&gt; <br /></code><br />That was easy (almost too easy). <br />Notice the use of the authGetPrimaryAccessToken(). This is a function that Citrix gives you to get the primary access token holding the credentials the user used to authenticate to Web Interface. This function can be found at <em>path_to_your_wi_server</em>\site\serverscripts\authentication.cs and <em>path_to_your_wi_server</em>\auth\serverscripts\authentication.cs<br /><br /><span class="heading">The code placement</span><br />Ok, now you know the down and dirty explanation and the code used to get the username and password. So, where do you put this code? One place you could use is the layout.ascx file located at <em>path_to_your_wi_server</em>\site\include. Layout.ascx is a user control that constructs the look and feel of the Web interface page after authentication (see this article for more information). Just place the code before the tag. Now you can use the variables strUsername and strPassword wherever you like in the code. <br /><br /><span class="heading">Putting it all together</span><br />Here is the final product<br /><br />Layout.ascx<br /><br /><code>&lt;%<br /><br />PasswordBasedToken pbt = null;<br />AccessToken ac = authGetPrimaryAccessToken();<br />pbt = (PasswordBasedToken)ac;<br />string strUsername = ac.getShortUserName();<br />string strPassword = pbt.getPassword();<br />%&gt;<br /><br />&lt;html&gt;<br />&lt;head&gt;<br />&nbsp; &lt;meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"&gt;<br />&nbsp; &lt;meta NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW, NOARCHIVE"&gt;<br />&nbsp; &lt;title&gt;&lt;%=PageTitle%&gt;&lt;/title&gt;<br />. . . <br /><br /></code>I hope this helps some of you out there trying to bring together disparate systems.</p>